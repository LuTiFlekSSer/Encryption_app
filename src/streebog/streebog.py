pi: list[int] = [252, 238, 221, 17, 207, 110, 49, 22, 251, 196, 250, 218, 35, 197, 4, 77,
                 233, 119, 240, 219, 147, 46, 153, 186, 23, 54, 241, 187, 20, 205, 95, 193,
                 249, 24, 101, 90, 226, 92, 239, 33, 129, 28, 60, 66, 139, 1, 142, 79,
                 5, 132, 2, 174, 227, 106, 143, 160, 6, 11, 237, 152, 127, 212, 211, 31,
                 235, 52, 44, 81, 234, 200, 72, 171, 242, 42, 104, 162, 253, 58, 206, 204,
                 181, 112, 14, 86, 8, 12, 118, 18, 191, 114, 19, 71, 156, 183, 93, 135,
                 21, 161, 150, 41, 16, 123, 154, 199, 243, 145, 120, 111, 157, 158, 178, 177,
                 50, 117, 25, 61, 255, 53, 138, 126, 109, 84, 198, 128, 195, 189, 13, 87,
                 223, 245, 36, 169, 62, 168, 67, 201, 215, 121, 214, 246, 124, 34, 185, 3,
                 224, 15, 236, 222, 122, 148, 176, 188, 220, 232, 40, 80, 78, 51, 10, 74,
                 167, 151, 96, 115, 30, 0, 98, 68, 26, 184, 56, 130, 100, 159, 38, 65,
                 173, 69, 70, 146, 39, 94, 85, 47, 140, 163, 165, 125, 105, 213, 149, 59,
                 7, 88, 179, 64, 134, 172, 29, 247, 48, 55, 107, 228, 136, 217, 231, 137,
                 225, 27, 131, 73, 76, 63, 248, 254, 141, 83, 170, 144, 202, 216, 133, 97,
                 32, 113, 103, 164, 45, 43, 9, 91, 203, 155, 37, 208, 190, 229, 108, 82,
                 89, 166, 116, 210, 230, 244, 180, 192, 209, 102, 175, 194, 57, 75, 99, 182]

tau: list[int] = [0, 8, 16, 24, 32, 40, 48, 56, 1, 9, 17, 25, 33, 41, 49, 57,
                  2, 10, 18, 26, 34, 42, 50, 58, 3, 11, 19, 27, 35, 43, 51, 59,
                  4, 12, 20, 28, 36, 44, 52, 60, 5, 13, 21, 29, 37, 45, 53, 61,
                  6, 14, 22, 30, 38, 46, 54, 62, 7, 15, 23, 31, 39, 47, 55, 63]

A: list[list[int]] = [[142, 32, 250, 167, 43, 160, 180, 112], [71, 16, 125, 221, 155, 80, 90, 56],
                      [173, 8, 176, 224, 195, 40, 45, 28], [216, 4, 88, 112, 239, 20, 152, 14],
                      [108, 2, 44, 56, 249, 10, 76, 7], [54, 1, 22, 28, 242, 5, 38, 141],
                      [27, 142, 11, 14, 121, 140, 19, 200], [131, 71, 139, 7, 178, 70, 135, 100],
                      [160, 17, 211, 128, 129, 142, 143, 64], [80, 134, 231, 64, 206, 71, 201, 32],
                      [40, 67, 253, 32, 103, 173, 234, 16], [20, 175, 240, 16, 189, 216, 117, 8],
                      [10, 217, 120, 8, 208, 108, 180, 4], [5, 226, 60, 4, 104, 54, 90, 2],
                      [140, 113, 30, 2, 52, 27, 45, 1], [70, 182, 15, 1, 26, 131, 152, 142],
                      [144, 218, 181, 42, 56, 122, 231, 111], [72, 109, 212, 21, 28, 61, 253, 185],
                      [36, 184, 106, 132, 14, 144, 240, 210], [18, 92, 53, 66, 7, 72, 120, 105],
                      [9, 46, 148, 33, 141, 36, 60, 186], [138, 23, 74, 158, 200, 18, 30, 93],
                      [69, 133, 37, 79, 100, 9, 15, 160], [172, 204, 156, 169, 50, 138, 137, 80],
                      [157, 77, 240, 93, 95, 102, 20, 81], [192, 168, 120, 160, 161, 51, 10, 166],
                      [96, 84, 60, 80, 222, 151, 5, 83], [48, 42, 30, 40, 111, 197, 140, 167],
                      [24, 21, 15, 20, 185, 236, 70, 221], [12, 132, 137, 10, 210, 118, 35, 224],
                      [6, 66, 202, 5, 105, 59, 159, 112], [3, 33, 101, 140, 186, 147, 193, 56],
                      [134, 39, 93, 240, 156, 232, 170, 168], [67, 157, 160, 120, 78, 116, 85, 84],
                      [175, 192, 80, 60, 39, 58, 164, 42], [217, 96, 40, 30, 157, 29, 82, 21],
                      [226, 48, 20, 15, 192, 128, 41, 132], [113, 24, 10, 137, 96, 64, 154, 66],
                      [182, 12, 5, 202, 48, 32, 77, 33], [91, 6, 140, 101, 24, 16, 168, 158],
                      [69, 108, 52, 136, 122, 56, 5, 185], [172, 54, 26, 68, 61, 28, 140, 210],
                      [86, 27, 13, 34, 144, 14, 70, 105], [43, 131, 136, 17, 72, 7, 35, 186],
                      [155, 207, 68, 134, 36, 141, 159, 93], [195, 233, 34, 67, 18, 200, 193, 160],
                      [239, 250, 17, 175, 9, 100, 238, 80], [249, 125, 134, 217, 138, 50, 119, 40],
                      [228, 250, 32, 84, 168, 11, 50, 156], [114, 125, 16, 42, 84, 139, 25, 78],
                      [57, 176, 8, 21, 42, 203, 130, 39], [146, 88, 4, 132, 21, 235, 65, 157],
                      [73, 44, 2, 66, 132, 251, 174, 192], [170, 22, 1, 33, 66, 243, 87, 96],
                      [85, 11, 142, 158, 33, 247, 165, 48], [164, 139, 71, 79, 158, 245, 220, 24],
                      [112, 166, 165, 110, 36, 64, 89, 142], [56, 83, 220, 55, 18, 32, 162, 71],
                      [28, 167, 110, 149, 9, 16, 81, 173], [14, 221, 55, 196, 138, 8, 166, 216],
                      [7, 224, 149, 98, 69, 4, 83, 108], [141, 112, 196, 49, 172, 2, 167, 54],
                      [200, 56, 98, 150, 86, 1, 221, 27], [100, 28, 49, 75, 43, 142, 224, 131]]

C: list[list[int]] = [[177, 8, 91, 218, 30, 202, 218, 233, 235, 203, 47, 129, 192, 101, 124, 31,
                       47, 106, 118, 67, 46, 69, 208, 22, 113, 78, 184, 141, 117, 133, 196, 252,
                       75, 124, 224, 145, 146, 103, 105, 1, 162, 66, 42, 8, 164, 96, 211, 21,
                       5, 118, 116, 54, 204, 116, 77, 35, 221, 128, 101, 89, 242, 166, 69, 7],
                      [111, 163, 181, 138, 169, 157, 47, 26, 79, 227, 157, 70, 15, 112, 181, 215,
                       243, 254, 234, 114, 10, 35, 43, 152, 97, 213, 94, 15, 22, 181, 1, 49,
                       154, 181, 23, 107, 18, 214, 153, 88, 92, 181, 97, 194, 219, 10, 167, 202,
                       85, 221, 162, 27, 215, 203, 205, 86, 230, 121, 4, 112, 33, 177, 155, 183],
                      [245, 116, 220, 172, 43, 206, 47, 199, 10, 57, 252, 40, 106, 61, 132, 53,
                       6, 241, 94, 95, 82, 156, 31, 139, 242, 234, 117, 20, 177, 41, 123, 123,
                       211, 226, 15, 228, 144, 53, 158, 177, 193, 201, 58, 55, 96, 98, 219, 9,
                       194, 182, 244, 67, 134, 122, 219, 49, 153, 30, 150, 245, 10, 186, 10, 178],
                      [239, 31, 223, 179, 232, 21, 102, 210, 249, 72, 225, 160, 93, 113, 228, 221,
                       72, 142, 133, 126, 51, 92, 60, 125, 157, 114, 28, 173, 104, 94, 53, 63,
                       169, 215, 44, 130, 237, 3, 214, 117, 216, 183, 19, 51, 147, 82, 3, 190,
                       52, 83, 234, 161, 147, 232, 55, 241, 34, 12, 190, 188, 132, 227, 209, 46],
                      [75, 234, 107, 172, 173, 71, 71, 153, 154, 63, 65, 12, 108, 169, 35, 99,
                       127, 21, 28, 31, 22, 134, 16, 74, 53, 158, 53, 215, 128, 15, 255, 189,
                       191, 205, 23, 71, 37, 58, 245, 163, 223, 255, 0, 183, 35, 39, 26, 22,
                       122, 86, 162, 126, 169, 234, 99, 245, 96, 23, 88, 253, 124, 108, 254, 87],
                      [174, 79, 174, 174, 29, 58, 211, 217, 111, 164, 195, 59, 122, 48, 57, 192,
                       45, 102, 196, 249, 81, 66, 164, 108, 24, 127, 154, 180, 154, 240, 142, 198,
                       207, 250, 166, 183, 28, 154, 183, 180, 10, 242, 31, 102, 194, 190, 198, 182,
                       191, 113, 197, 114, 54, 144, 79, 53, 250, 104, 64, 122, 70, 100, 125, 110],
                      [244, 199, 14, 22, 238, 170, 197, 236, 81, 172, 134, 254, 191, 36, 9, 84,
                       57, 158, 198, 199, 230, 191, 135, 201, 211, 71, 62, 51, 25, 122, 147, 201,
                       9, 146, 171, 197, 45, 130, 44, 55, 6, 71, 105, 131, 40, 74, 5, 4,
                       53, 23, 69, 76, 162, 60, 74, 243, 136, 134, 86, 77, 58, 20, 212, 147],
                      [155, 31, 91, 66, 77, 147, 201, 167, 3, 231, 170, 2, 12, 110, 65, 65,
                       78, 183, 248, 113, 156, 54, 222, 30, 137, 180, 68, 59, 77, 219, 196, 154,
                       244, 137, 43, 203, 146, 155, 6, 144, 105, 209, 141, 43, 209, 165, 196, 47,
                       54, 172, 194, 53, 89, 81, 168, 217, 164, 127, 13, 212, 191, 2, 231, 30],
                      [55, 143, 90, 84, 22, 49, 34, 155, 148, 76, 154, 216, 236, 22, 95, 222,
                       58, 125, 58, 27, 37, 137, 66, 36, 60, 217, 85, 183, 224, 13, 9, 132,
                       128, 10, 68, 11, 219, 178, 206, 177, 123, 43, 138, 154, 166, 7, 156, 84,
                       14, 56, 220, 146, 203, 31, 42, 96, 114, 97, 68, 81, 131, 35, 90, 219],
                      [171, 190, 222, 166, 128, 5, 111, 82, 56, 42, 229, 72, 178, 228, 243, 243,
                       137, 65, 231, 28, 255, 138, 120, 219, 31, 255, 225, 138, 27, 51, 97, 3,
                       159, 231, 103, 2, 175, 105, 51, 75, 122, 30, 108, 48, 59, 118, 82, 244,
                       54, 152, 250, 209, 21, 59, 182, 195, 116, 180, 199, 251, 152, 69, 156, 237],
                      [123, 205, 158, 208, 239, 200, 137, 251, 48, 2, 198, 205, 99, 90, 254, 148,
                       216, 250, 107, 187, 235, 171, 7, 97, 32, 1, 128, 33, 20, 132, 102, 121,
                       138, 29, 113, 239, 234, 72, 185, 202, 239, 186, 205, 29, 125, 71, 110, 152,
                       222, 162, 89, 74, 192, 111, 216, 93, 107, 202, 164, 205, 129, 243, 45, 27],
                      [55, 142, 231, 103, 241, 22, 49, 186, 210, 19, 128, 176, 4, 73, 177, 122,
                       205, 164, 60, 50, 188, 223, 29, 119, 248, 32, 18, 212, 48, 33, 159, 155,
                       93, 128, 239, 157, 24, 145, 204, 134, 231, 29, 164, 170, 136, 225, 40, 82,
                       250, 244, 23, 213, 217, 178, 27, 153, 72, 188, 146, 74, 241, 27, 215, 32]]


def L(x: list[int]) -> list[int]:
    result: list[int] = [0] * 64
    for i in range(8):
        for bit_pos in range(64):
            if (x[i * 8 + bit_pos // 8] >> (7 - (bit_pos % 8))) & 1:
                for j in range(8):
                    result[i * 8 + j] ^= A[bit_pos][j]

    return result


def P(x: list[int]) -> list[int]:
    return [x[tau[i]] for i in range(len(x))]


def S(x: list[int]) -> list[int]:
    return [pi[elem] for elem in x]


def X(x: list[int], k: list[int]) -> list[int]:
    return [x[i] ^ k[i] for i in range(len(x))]


def g(hsh: list[int], mess: list[int], sum_len: list[int]) -> list[int]:
    ks: list[list[int]] = [L(P(S(X(hsh, sum_len))))]
    for i in range(12):
        ks.append(L(P(S(X(ks[-1], C[i])))))
    hsh = X(hsh, mess)
    for i in range(12):
        mess = L(P(S(X(mess, ks[i]))))
    return X(X(mess, ks[12]), hsh)


def add_list(x: list[int], y: list[int]) -> list[int]:
    overlap = 0
    for i in range(63, -1, -1):
        x[i] += y[i] + overlap
        overlap = x[i] >> 8
        x[i] &= 0xFF

    return x


def H(data: bytes) -> bytes:
    hsh: list[int] = [0] * 64
    sum_len: list[int] = [0] * 64
    sum_mess: list[int] = [0] * 64
    data = list(data)
    while len(data) >= 64:
        mess = data[-64:]
        data = data[:-64]
        hsh = g(hsh, mess, sum_len)
        sum_len = add_list(sum_len, list((512).to_bytes(byteorder='big', length=64)))
        sum_mess = add_list(sum_mess, mess)

    mess = [0] * (64 - len(data) - 1) + [1] + data
    hsh = g(hsh, mess, sum_len)
    sum_len = add_list(sum_len, list((len(data) * 8).to_bytes(byteorder='big', length=64)))
    sum_mess = add_list(sum_mess, mess)
    hsh = g(hsh, sum_len, [0] * 64)
    hsh = g(hsh, sum_mess, [0] * 64)
    return bytes(hsh)
